services:
  abiotic-frontend:
    container_name: abiotic-frontend
    image: ghcr.io/r9r-dev/abiotic-crafting-notes-frontend:latest
    restart: unless-stopped
    depends_on:
    - abiotic-backend
    volumes:
    - ./data:/app/data:ro
    networks:
    - cadence
  abiotic-backend:
    container_name: abiotic-backend
    image: ghcr.io/r9r-dev/abiotic-crafting-notes-backend:latest
    environment:
    - TZ=Europe/Paris
    - POSTGRES_USER=${POSTGRES_USER}
    - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
    - POSTGRES_HOST=sql
    - POSTGRES_PORT=5432
    - POSTGRES_DB=abiotic-factor
    - DEV_MODE=false
    - ANALYTICS_SALT=${ANALYTICS_SALT}
    - ANALYTICS_PASSWORD=${ANALYTICS_PASSWORD}
    restart: unless-stopped
    volumes:
    - ./data:/app/data:ro
    networks:
    - cadence
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8080/api/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
networks:
  cadence:
    external: true
